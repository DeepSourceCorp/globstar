language: js
name: js_weak_crypto
message: Using cryptographically weak hash function
pattern: |
  (call_expression
    function: (member_expression
      object: (identifier) @obj
      property: (property_identifier) @method)
    (#match? @obj "^(crypto|CryptoJS|md5|sha1)$")
    (#match? @method "^(MD5|SHA1|sha1|md5)$"))
description: |
  MD5 and SHA1 are cryptographically broken hash functions that are vulnerable to collision attacks and should not be used for security purposes. Instead, use modern cryptographic hash functions like SHA-256, SHA-3, or better yet, dedicated password hashing functions like bcrypt, Argon2, or PBKDF2 for password storage.
