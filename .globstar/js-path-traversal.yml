language: js
name: js_path_traversal
message: Potential path traversal vulnerability detected
pattern: |
  (call_expression
    function: (member_expression
      object: (identifier) @obj
      property: (property_identifier) @method)
    (#match? @obj "^(fs|path)$")
    (#match? @method "^(readFile|readFileSync|writeFile|writeFileSync|unlink|readdir|access)$")) @js_path_traversal
exclude:
  - test/*
  - build/*
description: |
  Using unsanitized user input in filesystem operations can lead to path traversal attacks. Attackers might access files outside the intended directory using '../' sequences.
