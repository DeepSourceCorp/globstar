language: py
name: avoid-debug-and-allowed-hosts
message: Detected setting the value of ALLOWED_HOSTS = ["*"]
category: security

pattern: |
  (assignment_expression
    left: (identifier) @var (#eq? @var "ALLOWED_HOSTS")
    right: (array
      (string) @host_list
      (#match? @host_list "\\*")
    )
  ) @avoid-debug-and-allowed-hosts

inculde: ["**/settings.py"]
description: |
  ALLOWED_HOSTS = ["*"] cannot be used in production in django framework.

