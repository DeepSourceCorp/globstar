# .globstar/no_inner_html.yml

language: js 
name: insecure_cookie.yml 
message: Make httpOnly to true or secure to true or sameSite to Strict
category: security
# Capture name must be the same as the checker's `name` field.
# Nested captures are allowed to have arbitrary names
pattern: |
  
  (call_expression
    function: (member_expression
      object: (identifier)
      property: (property_identifier) @property
    )
    arguments: (arguments
      (string) ; First argument ('user')
      (_) ; Second argument ('john_doe')
      (object
        (pair
          key: (property_identifier) @insecure_key
          value: [(false) (string)] @insecure_value
        )+
      )
    )
    (#eq? @property "cookie")
    (#match? @insecure_key "httpOnly|secure|sameSite")
    (#eq? @insecure_value "false")
  ) @insecure_cookie

filters:
  # This will not flag any debugger statements
  # nested inside catch blocks
  - pattern-not-inside: (catch_clause)
  # Only match debugger statements inside a function
  # (or some other node that is inside a function)
  # - pattern-inside:     (function_declaration)

# files matching these patterns are excluded from analysis
exclude:
  - test/*
  - build/*
  - bin/*

description: |
  To identify cookies sent insecurly and which can be accessed direclty. 