# .globstar/insecure_cookie.yml

language: js 
name: insecure_cookie
message: Make httpOnly to true or secure to true or sameSite to Strict
category: security
pattern: |
  
  (call_expression
    function: (member_expression
      object: (identifier)
      property: (property_identifier) @property
    )
    arguments: (arguments
      (string) ; First argument ('user')
      (_) ; Second argument ('john_doe')
      (object
        (pair
          key: (property_identifier) @insecure_key
          value: [(false) (string)] @insecure_value
        )+
      )
    )
    (#eq? @property "cookie")
    (#match? @insecure_key "httpOnly|secure|sameSite")
    (#eq? @insecure_value "false")
  ) @insecure_cookie

description: |
  To identify cookies sent insecurly and which can be accessed direclty. 